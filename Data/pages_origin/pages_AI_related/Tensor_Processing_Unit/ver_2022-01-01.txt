{{short description|AI accelerator ASIC by Google}}
{{About|the chip developed by Google|for the smartphone system-on-chip|Google Tensor|other devices that provide tensor processing for artificial intelligence|AI accelerator}}
{{Infobox CPU architecture
| name        = Tensor Processing Unit
| image       = Tensor Processing Unit 3.0.jpg
| caption     = Tensor Processing Unit 3.0
| designer    = [[Google]]
| bits        = 
| introduced  = May 2016
| version     = 
| design      = 
| type        = [[Artificial neural network|Neural network]]<br/> [[Machine learning]]
| encoding    = 
| branching   = 
| endianness  = 
| page size   = 
| extensions  = 
| open        = 
| predecessor = 
| successor   = 
| registers   = 
| gpr         = 
| fpr         = 
}}

'''Tensor Processing Unit''' ('''TPU''') is an [[AI accelerator]] [[application-specific integrated circuit]] (ASIC) developed by [[Google]] specifically for [[Artificial neural network|neural network]] [[machine learning]], particularly using Google's own [[TensorFlow]] software.<ref>{{cite web |title=Cloud Tensor Processing Units (TPUs) |url=https://cloud.google.com/tpu/docs/tpus |website=Google Cloud |access-date=20 July 2020}}</ref> Google began using TPUs internally in 2015, and in 2018 made them available for third party use, both as part of its cloud infrastructure and by offering a smaller version of the chip for sale.

==Overview==
The tensor processing unit was announced in May 2016 at [[Google I/O]], when the company said that the TPU had already been used inside [[Google Data Centers|their data centers]] for over a year.<ref name=":0" /><ref name="GCP blog 2016" /> The chip has been specifically designed for Google's [[TensorFlow]] framework, a symbolic math library which is used for [[machine learning]] applications such as [[neural networks]].<ref name=YoutubeClip>[https://www.youtube.com/watch?v=oZikw5k_2FM "TensorFlow: Open source machine learning"] "It is machine learning software being used for various kinds of perceptual and language understanding tasks" — Jeffrey Dean, minute 0:47 / 2:17 from Youtube clip</ref> However, as of 2017 Google still used [[Central processing unit|CPUs]] and [[Graphics processing unit|GPUs]] for other types of [[machine learning]].<ref name=":0">{{Cite news|url=http://www.techradar.com/news/computing-components/processors/google-s-tensor-processing-unit-explained-this-is-what-the-future-of-computing-looks-like-1326915|title=Google's Tensor Processing Unit explained: this is what the future of computing looks like|newspaper=TechRadar|language=en|access-date=2017-01-19}}</ref> Other [[AI accelerator]] designs are appearing from other vendors also and are aimed at [[embedded computing|embedded]] and [[robotics]] markets.

Google's TPUs are proprietary. Some models are commercially available, and on February 12, 2018, ''The New York Times'' reported that Google "would allow other companies to buy access to those chips through its cloud-computing service."<ref>{{Cite news|url=https://www.nytimes.com/2018/02/12/technology/google-artificial-intelligence-chips.html|title=Google Makes Its Special A.I. Chips Available to Others|newspaper=The New York Times|language=en|access-date=2018-02-12}}</ref>  Google has said that they were used in the [[AlphaGo versus Lee Sedol]] series of man-machine [[Go (game)|Go]] games,<ref name="GCP blog 2016" /> as well as in the [[AlphaZero]] system, which produced [[Chess]], [[Shogi]] and Go playing programs from the game rules alone and went on to beat the leading programs in those games.<ref>{{Cite web|url=https://chess24.com/en/read/news/deepmind-s-alphazero-crushes-chess|title=DeepMind's AlphaZero crushes chess|last=McGourty|first=Colin|date=6 December 2017|website=chess24.com|language=en}}</ref> Google has also used TPUs for [[Google Street View]] text processing and was able to find all the text in the Street View database in less than five days. In [[Google Photos]], an individual TPU can process over 100 million photos a day{{Citation needed|date=May 2021}}. It is also used in [[RankBrain]] which Google uses to provide search results.<ref>{{Cite news|url=http://www.pcworld.com/article/3072256/google-io/googles-tensor-processing-unit-said-to-advance-moores-law-seven-years-into-the-future.html|title=Google's Tensor Processing Unit could advance Moore's Law 7 years into the future|newspaper=PCWorld|language=en|access-date=2017-01-19}}</ref>

Compared to a [[graphics processing unit]], it is designed for a high volume of low precision computation (e.g. as little as [[8-bit]] precision)<ref>{{Cite web|url=http://www.tomshardware.com/news/google-tensor-processing-unit-machine-learning,31834.html|title=Google's Big Chip Unveil For Machine Learning: Tensor Processing Unit With 10x Better Efficiency (Updated)|last=Armasu|first=Lucian|date=2016-05-19|website=Tom's Hardware|access-date=2016-06-26}}</ref> with more input/output operations per [[joule]], without hardware for rasterisation/[[texture mapping]].<ref name="GCP blog 2016">{{Cite web|url=https://cloudplatform.googleblog.com/2016/05/Google-supercharges-machine-learning-tasks-with-custom-chip.html|title=Google supercharges machine learning tasks with TPU custom chip|last=Jouppi|first=Norm|date=May 18, 2016|website=Google Cloud Platform Blog|language=en-US|access-date=2017-01-22}}</ref> The TPU [[Application-specific integrated circuit|ASICs]] are mounted in a heatsink assembly, which can fit in a hard drive slot within a data center [[19-inch rack|rack]], according to [[Norman Jouppi]].<ref name=":0" /> Different types of processors are suited for different types of machine learning models, TPUs are well suited for [[Convolutional neural network|CNNs]] while GPUs have benefits for some fully-connected neural networks, and CPUs can have advantages for [[Recurrent neural network|RNNs]].<ref>{{cite arxiv|last1=Wang|first1=Yu Emma|last2=Wei|first2=Gu-Yeon|last3=Brooks|first3=David|date=2019-07-01|title=Benchmarking TPU, GPU, and CPU Platforms for Deep Learning|class=cs.LG|eprint=1907.10701}}</ref>

Google provides third parties access to TPUs through its ''Cloud TPU'' service as part of the [[Google Cloud Platform]]<ref>{{Cite web|title=Frequently Asked Questions {{!}} Cloud TPU|url=https://cloud.google.com/tpu/docs/faq|access-date=2021-01-14|website=Google Cloud|language=en}}</ref> and through its [[Project Jupyter|notebook-based]] services [[Kaggle]] and [[Colaboratory]].<ref>{{Cite web|title=Google Colaboratory|url=https://colab.research.google.com/notebooks/tpu.ipynb|access-date=2021-05-15|website=colab.research.google.com|language=en}}</ref><ref>{{Cite web|title=Use TPUs {{!}} TensorFlow Core|url=https://www.tensorflow.org/guide/tpu|access-date=2021-05-15|website=TensorFlow|language=en}}</ref>

==Products<ref>https://conferences.computer.org/iscapub/pdfs/ISCA2021-4ghucdBnCWYB7ES2Pe4YdT/333300a001/333300a001.pdf</ref>==

{| class="wikitable"
|-
!  !! TPUv1 !! TPUv2 !! TPUv3 !! TPUv4<ref>[https://cloud.google.com/blog/products/ai-machine-learning/google-breaks-ai-performance-records-in-mlperf-with-worlds-fastest-training-supercomputer Stay tuned, more information on TPU v4 is coming soon],  Retrieved 2020-08-06.</ref> !! Edge v1
|-
| Date Introduced  || 2016 || 2017 || 2018 || 2021 || 2018
|-
| [[Semiconductor device fabrication|Process Node]] || 28&nbsp;nm || 16&nbsp;nm|| 16&nbsp;nm || 7&nbsp;nm ||
|-
| Die Size (mm2) || 331 || < 625 || < 700 || < 400 ||
|-
| On chip memory (MiB) || 28 || 32 || 32 || 144 ||
|-
| Clock Speed (MHz) || 700 || 700 || 940 || 1050 ||
|-
| Memory (GB) || 8GB DDR3|| 16GB HBM|| 32GB HBM || 8GB ||
|-
| [[Thermal design power|TDP]](W) || 75 || 280 || 450 || 175 || 2
|-
| TOPS (Tera Operations Per Second) || 23 || 45 || 90 || {{dunno}} || 4
|}

===First generation TPU===
The first-generation TPU is an [[8-bit]] [[matrix multiplication]] engine, driven with [[CISC instruction]]s by the host processor across a [[PCI Express#PCI Express 3.0|PCIe&nbsp;3.0]] bus. It is manufactured on a [[28 nm]] process with a die size ≤ 331&nbsp;[[Millimetre|mm]]<sup>2</sup>. The [[clock speed]] is 700&nbsp;[[MHz]] and it has a [[thermal design power]] of 28–40&nbsp;[[Watt|W]]. It has 28&nbsp;[[MiB]] of on chip memory, and 4&nbsp;[[MiB]] of [[32-bit]] [[accumulator (computing)|accumulator]]s taking the results of a 256×256 [[systolic array]] of 8-bit [[Binary multiplier|multiplier]]s.<ref name=InDatacenterPerformanceAnalysisOfATensorProcessingUnit-2017>
{{cite conference
	| last1 = Jouppi | first1 = Norman P.
	| last2 = Young | first2 = Cliff
	| last3 = Patil | first3 = Nishant
	| last4 = Patterson | first4 = David
	| last5 = Agrawal | first5 = Gaurav
	| last6 = Bajwa | first6 = Raminder
	| last7 = Bates | first7 = Sarah
	| last8 = Bhatia | first8 = Suresh
	| last9 = Boden | first9 = Nan
	| last10 = Borchers | first10 = Al
	| last11 = Boyle | first11 = Rick
	| last12 = Cantin | first12 = Pierre-luc
	| last13 = Chao | first13 = Clifford
	| last14 = Clark | first14 = Chris
	| last15 = Coriell | first15 = Jeremy
	| last16 = Daley | first16 = Mike
	| last17 = Dau | first17 = Matt
	| last18 = Dean | first18 = Jeffrey
	| last19 = Gelb | first19 = Ben
	| last20 = Ghaemmaghami | first20 = Tara Vazir
	| last21 = Gottipati | first21 = Rajendra
	| last22 = Gulland | first22 = William
	| last23 = Hagmann | first23 = Robert
	| last24 = Ho | first24 = C. Richard
	| last25 = Hogberg | first25 = Doug
	| last26 = Hu | first26 = John
	| last27 = Hundt | first27 = Robert
	| last28 = Hurt | first28 = Dan
	| last29 = Ibarz | first29 = Julian
	| last30 = Jaffey | first30 = Aaron
	| last31 = Jaworski | first31 = Alek
	| last32 = Kaplan | first32 = Alexander
	| last33 = Khaitan | first33 = Harshit
	| last34 = Koch | first34 = Andy
	| last35 = Kumar | first35 = Naveen
	| last36 = Lacy | first36 = Steve
	| last37 = Laudon | first37 = James
	| last38 = Law | first38 = James
	| last39 = Le | first39 = Diemthu
	| last40 = Leary | first40 = Chris
	| last41 = Liu | first41 = Zhuyuan
	| last42 = Lucke | first42 = Kyle
	| last43 = Lundin | first43 = Alan
	| last44 = MacKean | first44 = Gordon
	| last45 = Maggiore | first45 = Adriana
	| last46 = Mahony | first46 = Maire
	| last47 = Miller | first47 = Kieran
	| last48 = Nagarajan | first48 = Rahul
	| last49 = Narayanaswami | first49 = Ravi
	| last50 = Ni | first50 = Ray
	| last51 = Nix | first51 = Kathy
	| last52 = Norrie | first52 = Thomas
	| last53 = Omernick | first53 = Mark
	| last54 = Penukonda | first54 = Narayana
	| last55 = Phelps | first55 = Andy
	| last56 = Ross | first56 = Jonathan
	| last57 = Ross | first57 = Matt
	| last58 = Salek | first58 = Amir
	| last59 = Samadiani | first59 = Emad
	| last60 = Severn | first60 = Chris
	| last61 = Sizikov | first61 = Gregory
	| last62 = Snelham | first62 = Matthew
	| last63 = Souter | first63 = Jed
	| last64 = Steinberg | first64 = Dan
	| last65 = Swing | first65 = Andy
	| last66 = Tan | first66 = Mercedes
	| last67 = Thorson | first67 = Gregory
	| last68 = Tian | first68 = Bo
	| last69 = Toma | first69 = Horia
	| last70 = Tuttle | first70 = Erick
	| last71 = Vasudevan | first71 = Vijay
	| last72 = Walter | first72 = Richard
	| last73 = Wang | first73 = Walter
	| last74 = Wilcox | first74 = Eric
	| last75 = Yoon | first75 = Doe Hyun
 | title = In-Datacenter Performance Analysis of a Tensor Processing Unit™
 | date = June 26, 2017
 | location = Toronto, Canada
 | arxiv = 1704.04760
	}}
</ref> Within the TPU package is 8&nbsp;[[Gibibyte|GiB]] of [[dual-channel]] 2133&nbsp;MHz [[DDR3&nbsp;SDRAM]] offering 34&nbsp;GB/s of bandwidth.<ref name='TPU_memory'>{{cite news|last1=Kennedy|first1=Patrick|title=Case Study on the Google TPU and GDDR5 from Hot Chips 29|url=https://www.servethehome.com/case-study-google-tpu-gddr5-hot-chips-29/|access-date=23 August 2017|publisher=Serve The Home|date=22 August 2017}}</ref> Instructions transfer data to or from the host, perform matrix multiplications or [[convolution]]s, and apply [[activation function]]s.<ref name=InDatacenterPerformanceAnalysisOfATensorProcessingUnit-2017 />

===Second generation TPU===
The second-generation TPU was announced in May 2017.<ref name='TFP_v2'>{{cite news|last1=Bright|first1=Peter|title=Google brings 45 teraflops tensor flow processors to its compute cloud|url=https://arstechnica.com/information-technology/2017/05/google-brings-45-teraflops-tensor-flow-processors-to-its-compute-cloud/|access-date=30 May 2017|publisher=Ars Technica|date=17 May 2017}}</ref> Google stated the first-generation TPU design was limited by [[memory bandwidth]] and using 16 [[Gigabyte|GB]] of [[High Bandwidth Memory]] in the second-generation design increased bandwidth to 600&nbsp;GB/s and performance to 45&nbsp;tera[[FLOPS]].<ref name='TPU_memory' /> The TPUs are then arranged into four-chip modules with a performance of 180&nbsp;teraFLOPS.<ref name='TFP_v2' /> Then 64 of these modules are assembled into 256-chip pods with 11.5&nbsp;petaFLOPS of performance.<ref name='TFP_v2' /> Notably, while the first-generation TPUs were limited to integers, the second-generation TPUs can also calculate in [[Floating-point arithmetic|floating point]]. This makes the second-generation TPUs useful for both training and inference of machine learning models. Google has stated these second-generation TPUs will be available on the [[Google Compute Engine]] for use in TensorFlow applications.<ref>{{cite news|last1=Kennedy|first1=Patrick|title=Google Cloud TPU Details Revealed|url=https://www.servethehome.com/google-cloud-tpu-details-revealed/|access-date=30 May 2017|publisher=Serve The Home|date=17 May 2017}}</ref>

=== Third generation TPU===
The third-generation TPU was announced on May 8, 2018.<ref>{{cite news|last1=Frumusanu|first1=Andre|title=Google I/O Opening Keynote Live-Blog|url=https://www.anandtech.com/show/12726/google-io-keynote-liveblog-10am-pt|access-date=9 May 2018|date=8 May 2018}}</ref> Google announced that processors themselves are twice as powerful as the second-generation TPUs, and would be deployed in pods with four times as many chips as the preceding generation.<ref>{{cite news|last1=Feldman|first1=Michael|title=Google Offers Glimpse of Third-Generation TPU Processor|url=https://www.top500.org/news/google-offers-glimpse-of-third-generation-tpu-processor/|access-date=14 May 2018|publisher=Top 500|date=11 May 2018}}</ref><ref>{{cite news|last1=Teich|first1=Paul|title=Tearing Apart Google's TPU 3.0 AI Coprocessor|url=https://www.nextplatform.com/2018/05/10/tearing-apart-googles-tpu-3-0-ai-coprocessor/|access-date=14 May 2018|publisher=The Next Platform|date=10 May 2018}}</ref> This results in an 8-fold increase in performance per pod (with up to 1,024 chips per pod) compared to the second-generation TPU deployment.

=== Fourth generation TPU ===
On May 18, 2021, Google CEO Sundar Pichai spoke about TPU v4 Tensor Processing Units during his keynote at the Google I/O virtual conference. TPU v4 improved performance by more than 2x over TPU v3 chips. Pichai said "A single v4 pod contains 4,096 v4 chips, and each pod has 10x the interconnect bandwidth per chip at scale, compared to any other networking technology.”<ref>https://www.hpcwire.com/2021/05/20/google-launches-tpu-v4-ai-chips/ Retrieved June 7, 2021.</ref>

===Edge TPU===
In July 2018, Google announced the Edge TPU. The Edge TPU is Google's purpose-built [[Application-specific integrated circuit|ASIC]] chip designed to run machine learning (ML) models for [[edge computing]], meaning it is much smaller and consumes far less power compared to the TPUs hosted in Google datacenters (also known as Cloud TPUs<ref>{{Cite web|title=Cloud TPU|url=https://cloud.google.com/tpu|access-date=2021-05-21|website=Google Cloud|language=en}}</ref>). In January 2019, Google made the Edge TPU available to developers with a line of products under the [[Coral (AI)|Coral]] brand. The Edge TPU is capable of 4 trillion operations per second while using 2W.<ref>{{Cite web|url=https://coral.ai/docs/edgetpu/benchmarks/|title=Edge TPU performance benchmarks|website=Coral|language=en-us|access-date=2020-01-04}}</ref>

The product offerings include a [[single board computer]] (SBC), a [[system on module]] (SoM), a [[USB]] accessory, a mini [[PCI-e]] card, and an [[M.2]] card. The [[Single Board Computer|SBC]] Coral Dev Board and Coral SoM both run Mendel Linux OS – a derivative of [[Debian]].<ref>{{Cite web|title=Dev Board|url=https://coral.ai/products/dev-board|access-date=2021-05-21|website=Coral|language=en-us}}</ref><ref>{{Cite web|title=System-on-Module (SoM)|url=https://coral.ai/products/som|access-date=2021-05-21|website=Coral|language=en-us}}</ref> The USB, PCI-e, and M.2 products function as add-ons to existing computer systems, and support Debian-based Linux systems on x86-64 and ARM64 hosts (including [[Raspberry Pi]]).

The machine learning runtime used to execute models on the Edge TPU is based on [[TensorFlow|TensorFlow Lite]].<ref>{{Cite web|url=https://www.blog.google/products/google-cloud/bringing-intelligence-to-the-edge-with-cloud-iot/|title=Bringing intelligence to the edge with Cloud IoT|date=2018-07-25|website=Google Blog|language=en-US|access-date=2018-07-25}}</ref> The Edge TPU is only capable of accelerating forward-pass operations, which means it's primarily useful for performing inferences (although it is possible to perform lightweight transfer learning on the Edge TPU<ref>{{Cite web|url=https://coral.withgoogle.com/docs/edgetpu/retrain-classification-ondevice/|title=Retrain an image classification model on-device|access-date=2019-05-03|website=Coral}}</ref>). The Edge TPU also only supports 8-bit math, meaning that for a network to be compatible with the Edge TPU, it needs to either be trained using the TensorFlow quantization-aware training technique, or since late 2019 it's also possible to use post-training quantization.

On November 12, 2019, [[Asus]] announced a pair of [[Single-board computer|single-board computer (SBCs)]] featuring the Edge TPU. The [[Asus Tinker Board|Asus Tinker Edge T and Tinker Edge R Board]] designed for [[Internet of things|IoT]] and [[Edge computing|edge]] [[AI]]. The SBCs officially support [[Android (operating system)|Android]] and [[Debian]] [[operating system]]s.<ref>{{Cite web|url=https://www.asus.com/jp/News/jr4skqts65jsuggg|title=組込み総合技術展＆IoT総合技術展「ET & IoT Technology 2019」に出展することを発表|website=Asus.com|language=ja-JP|access-date=2019-11-13}}</ref><ref>{{Cite web|url=https://www.anandtech.com/show/15095/asus-google-team-up-for-tinker-board-aifocused-creditcard-sized-computers|title=ASUS & Google Team Up for 'Tinker Board' AI-Focused Credit-Card Sized Computers|last=Shilov|first=Anton|website=Anandtech.com|access-date=2019-11-13}}</ref> ASUS has also demonstrated a mini PC called Asus PN60T featuring the Edge TPU.<ref>{{Cite web|url=https://www.cnx-software.com/2019/05/29/asus-tinker-edge-t-cr1s-cm-a-sbc-google-coral-edge-tpu-nxp-i-mx-8m-processor |title=ASUS Tinker Edge T & CR1S-CM-A SBC to Feature Google Coral Edge TPU & NXP i.MX 8M Processor|last=Aufranc|first=Jean-Luc|date=2019-05-29|website=CNX Software - Embedded Systems News|language=en-US|access-date=2019-11-14}}</ref>

On January 2, 2020, Google announced the Coral Accelerator Module and Coral Dev Board Mini, to be demonstrated at [[Consumer Electronics Show|CES 2020]] later the same month. The Coral Accelerator Module is a [[multi-chip module]] featuring the Edge TPU, PCIe and USB interfaces for easier integration. The Coral Dev Board Mini is a smaller [[single board computer|SBC]] featuring the Coral Accelerator Module and [[MediaTek|MediaTek 8167s SoC]].<ref>{{Cite web|url=https://developers.googleblog.com/2020/01/new-coral-products-for-2020.html|title=New Coral products for 2020|website=Google Developers Blog|language=en|access-date=2020-01-04}}</ref><ref>{{Cite web|url=https://coral.ai/products/accelerator-module|title=Accelerator Module|website=Coral|language=en-us|access-date=2020-01-04}}</ref>

=== Pixel Neural Core ===
On October 15, 2019, Google announced the [[Pixel 4]] smartphone, which contains an Edge TPU called the [[Pixel Neural Core]].<ref>{{Cite web|url=http://ai.googleblog.com/2019/11/introducing-next-generation-on-device.html|title=Introducing the Next Generation of On-Device Vision Models: MobileNetV3 and MobileNetEdgeTPU|website=Google AI Blog|language=en|access-date=2020-04-16}}</ref>

== See also ==
* [[Structure tensor]] a mathematical foundation for TPU's.
* [[Vision processing unit]] a similar device specialised for vision processing.
* [[TrueNorth]] a similar device simulating [[Spiking neural network|spiking neuron]]s instead of low precision tensors.
* [[Neural processing unit]]
* [[Cognitive computer]]
* [[Tensor Core]], a similar architecture proposed by [[Nvidia]]

==References==
{{Reflist|30em}}
{{Authority control}}

== External links ==
*[https://cloud.google.com/tpu/docs/tpus Cloud Tensor Processing Units (TPUs)] (Documentation from Google Cloud)
*[https://images.anandtech.com/doci/12195/google-tpu-board-2.png Photo of Google's TPU chip and board]
* [https://cloud.google.com/images/products/tpu/cloud-tpu-v2.png Photo of Google's TPU v2 board]
* [https://cloud.google.com/images/products/tpu/cloud-tpu-v3-alpha.png Photo of Google's TPU v3 board]
* [https://cloud.google.com/images/products/tpu/cloud-tpu-v2-pod-alpha.png Photo of Google's TPU v2 pod]

{{Google LLC}}
{{Differentiable computing}}
{{Digital electronics}}

[[Category:AI accelerators]]
[[Category:Application-specific integrated circuits]]
[[Category:Computer-related introductions in 2016]]
[[Category:Google hardware]]
[[Category:Microprocessors]]