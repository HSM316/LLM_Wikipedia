In [[image registration]], '''inverse consistency''' measures the consistency of mappings between images produced by a [[image registration|registration]] algorithm. The inverse consistency error, introduced by Christiansen and Johnson in 2001, quantifies the distance between the composition of the mappings from each image to the other, produced by the registration procedure, and the [[identity function]], and is used as a [[regularization (mathematics)|regularisation]] constraint in the [[loss function]] of many registration algorithms to enforce consistent mappings.<ref name="C&J">Christiansen and Johnson (2001)</ref><ref>Bhatia et al. (2004)</ref><ref>Johnson and Christensen (2002)</ref><ref>Arganda-Carreras et al. (2006)</ref> Inverse consistency is necessary for good image registration but it is not sufficient, since a mapping can be perfectly consistent but not register the images at all.<ref name="Rohlfing">Rohlfing (2012)</ref>

== Definition ==

Image registration is the process of establishing a common [[coordinate system]] between two images, and given two [[digital image|image]]s
:<math>
\begin{align}
    I_1: \Omega_1 \to \mathbb{R} \\
    I_2: \Omega_2 \to \mathbb{R}
\end{align}
</math>
registering a source image <math>I_1</math> to a target image <math>I_2</math> consists of determining a transformation <math>f_1: \Omega_2 \to \Omega_1</math> that maps points from the target space to the source space.<ref>The transformation goes in this direction in order to allow resampling the source image in target space.</ref> An ideal registration algorithm should not be sensitive to which image in the pair is used as source or target, and the registration operator should be [[symmetric function|antisymmetric]] such that the mappings
:<math>
\begin{align}
    f_1: \Omega_2 \to \Omega_1 \\
    f_2: \Omega_1 \to \Omega_2
\end{align}
</math>
produced when registering <math>I_1</math> to <math>I_2</math> and <math>I_2</math> to <math>I_1</math> respectively should be the [[inverse function|inverse]] of each other, i.e. <math>f_2 = f_1^{-1}</math> and <math>f_1 = f_2^{-1}</math> or, equivalently, <math>f_2 \circ f_1 = \operatorname{id}_{\Omega_2}</math> and <math>f_1 \circ f_2 = \operatorname{id}_{\Omega_1}</math>, where <math>\circ</math> denotes the [[function composition]] operator.<ref name="B&T">Bender and Tomé (2009)</ref><ref name="Leow">Leow et al. (2005)</ref>

Real algorithms are not perfect, and when swapping the role of source and target image in a registration problem the so obtained transformations are not the inverse of each other. Inverse consistency can be enforced by adding to the [[loss function]] of the registration a symmetric regularisation term that penalises inconsistent transformations<ref name="C&J">Christiansen and Johnson (2001)</ref>
:<math>
\int_{\Omega_2} \left\Vert f_2(f_1(x)) - x \right\Vert^2 \mathrm{d}x +
\int_{\Omega_1} \left\Vert f_1(f_2(x)) - x \right\Vert^2 \mathrm{d}x .
</math>

Inverse consistency can be used as a quality metric to evaluate image registration results. The inverse consistency error (<math>ICE</math>) measures the distance between the composition of the two transforms and the identity function, and it can be formulated in terms of both average (<math>ICE_a</math>) or maximum (<math>ICE_m</math>) over a [[region of interest]] <math>\Omega</math> of the image:<ref name="B&K">Beg and Khan (2007)</ref>
:<math>
\begin{align}
    ICE_a &= \frac{1}{\int_{\Omega} \mathrm{d}x} \int_{\Omega} \left\Vert f_2(f_1(x)) - x \right\Vert \mathrm{d}x \\
    ICE_m &= \max_{x \in \Omega} \left\Vert f_2(f_1(x)) - x \right\Vert .
\end{align}
</math>
While inverse consistency is a necessary property of good registration algorithms, inverse consistency error alone is not a sufficient metric to evaluate the quality of image registration results, since a perfectly consistent mapping, with no other constraint, may be not even close to correctly register a pair of images.<ref name="Rohlfing" />

== References ==
<references />
* {{cite conference|last1=Arganda-Carreras|first1=Ignacio|first2=Carlos OS|last2=Sorzano|first3=Roberto|last3=Marabini|first4=José María|last4=Carazo|first5=Carlos|last5=Ortiz-de-Solorzano|first6=Jan|last6=Kybic|title=Consistent and elastic registration of histological sections using vector-spline regularization|conference=International Workshop on Computer Vision Approaches to Medical Image Analysis|pages=85–95|publisher=Springer|year=2006}}
* {{cite conference|last1=Bhatia|first1=Kanwal K.|first2=Joseph V.|last2=Hajnal|first3=Basant K.|last3=Puri|first4=A. David|last4=Edwards|first5=Daniel|last5=Rueckert|title=Consistent groupwise non-rigid registration for atlas construction|conference=IEEE International Symposium on Biomedical Imaging|pages=908–911|publisher=IEEE|year=2004}}
* {{cite journal|title=Consistent image registration|year=2001|journal=IEEE Transactions on Medical Imaging|volume=20|pages=568–582|issue=7|publisher=IEEE|last1=Christensen|first1=Gary E|last2=Johnson|first2=Hans J|doi=10.1109/42.932742|pmid=11465464}}
* {{cite journal|last1=Bender|first1=Edward T.|first2=Wolfgang A.|last2=Tomé|title=The utilization of consistency metrics for error analysis in deformable image registration|journal=Physics in Medicine & Biology|volume=54|number=18|year=2009|pages=5561–77|doi=10.1088/0031-9155/54/18/014|pmid=19717890|pmc=2798737|bibcode=2009PMB....54.5561B}}
* {{cite conference|title=Inverse consistent mapping in 3D deformable image registration: its construction and statistical properties|book-title=Biennial International Conference on Information Processing in Medical Imaging|year=2005|last1=Leow|first1=Alex|last2=Huang|first2=Sung-Cheng|last3=Geng|first3=Alex|last4=Becker|first4=James|last5=Davis|first5=Simon|last6=Toga|first6=Arthur|last7=Thompson|first7=Paul}}
* {{cite journal|last1=Beg|first1=Mirza Faisal|first2=Ali|last2=Khan|title=Symmetric data attachment terms for large deformation image registration|journal=IEEE Transactions on Medical Imaging|volume=26 |number=9|year=2007|pages=1179–1189|doi=10.1109/TMI.2007.898813|pmid=17896591}}
* {{cite journal|last1=Johnson|first1=Hans J.|first2=Gary E.|last2=Christensen|title=Consistent landmark and intensity-based image registration|journal=IEEE Transactions on Medical Imaging|volume=21|number=5|year=2002|pages=450–461|doi=10.1109/TMI.2002.1009381|pmid=12071616}}
* {{cite journal|title=Image similarity and tissue overlaps as surrogates for image registration accuracy: widely used but unreliable|year=2012|journal=IEEE Transactions on Medical Imaging|volume=31|pages=153–163|issue=2|publisher=IEEE|last1=Rohlfing|first1=Torsten|doi=10.1109/TMI.2011.2163944|pmid=21827972|pmc=3274625}}

== External links ==
* [http://user.engineering.uiowa.edu/~n-morph/research/invert_and_trans/node11.html Inverse consistency error]

[[Category:Computer vision]]